import {
  collection,
  deleteDoc,
  doc,
  onSnapshot,
  setDoc,
} from "firebase/firestore"
import React, { useEffect, useState } from "react"
import db from "../../firebase"
import styles from "./admin.module.css"
import { Link } from "react-router-dom"

function AdminSection() {
  const [services, setServices] = useState([
    { status: "loading", id: "initing" },
  ])
  useEffect(() => {
    onSnapshot(collection(db, "services"), (snapshot) =>
      setServices(snapshot.docs.map((doc) => ({ ...doc.data(), id: doc.id })))
    )
  }, [])

  return services.map((el) => (
    <div className={styles.adminItem} key={el.id}>
      <img src={el.image} alt="" />
      <p>{el.title}</p>
      <p>{el.description}</p>
      <Link to={"/edit/" + el.id}>
        <svg
          width="42"
          height="44"
          viewBox="0 0 21 22"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M19.5099 1.58002C18.9487 1.02336 18.1904 0.710709 17.3999 0.710022C16.7152 0.712249 16.0518 0.948672 15.5199 1.38002L6.14992 9.00002L5.99992 9.15002C4.69395 10.4448 4.40424 12.4483 5.28992 14.06C4.92656 13.9492 4.54972 13.8886 4.16992 13.88C1.96078 13.88 0.169922 15.6709 0.169922 17.88V20.38C0.169922 21.2084 0.841495 21.88 1.66992 21.88H4.16992C5.55853 21.8724 6.84384 21.1452 7.56546 19.9588C8.28709 18.7724 8.34177 17.2966 7.70992 16.06C8.1096 16.195 8.5281 16.2658 8.94992 16.27C10.0575 16.2775 11.1211 15.8376 11.8999 15.05L11.9999 14.94L19.6699 5.57002C20.6381 4.39253 20.5692 2.67621 19.5099 1.58002ZM4.20992 20.38H1.70992V17.88C1.70992 16.4993 2.82921 15.38 4.20992 15.38C5.59063 15.38 6.70992 16.4993 6.70992 17.88C6.70992 19.2607 5.59063 20.38 4.20992 20.38ZM10.8799 14L18.5499 4.62002C19.0201 4.03111 18.9727 3.18297 18.4398 2.65012C17.907 2.11727 17.0588 2.06987 16.4699 2.54002L7.09992 10.21C6.05334 11.2538 6.0511 12.9484 7.09492 13.995C8.13874 15.0416 9.83334 15.0438 10.8799 14Z"
            fill="var(--text-color)"
          />
          <path
            d="M11.1999 8.83002L8.19992 11.83C7.90747 12.1228 7.90747 12.5972 8.19992 12.89C8.49274 13.1825 8.9671 13.1825 9.25992 12.89L12.2599 9.89002C12.4606 9.70305 12.5432 9.42147 12.4753 9.15573C12.4074 8.89 12.1999 8.6825 11.9342 8.61464C11.6685 8.54677 11.3869 8.62937 11.1999 8.83002Z"
            fill="var(--text-color)"
          />
        </svg>
      </Link>
      <button onClick={async () => await deleteDoc(doc(db, "services", el.id))}>
        <svg
          width="32"
          height="40"
          viewBox="0 0 16 20"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M14.79 5C14.3537 5 14 5.35369 14 5.79V14.63C14 16.4912 12.4912 18 10.63 18H4.95C3.0888 18 1.58 16.4912 1.58 14.63V5.79C1.58 5.35369 1.22631 5 0.79 5C0.353695 5 1.30029e-08 5.35369 0 5.79V14.63C0.0274201 17.3719 2.25799 19.5801 5 19.58H10.68C13.4025 19.5529 15.6029 17.3525 15.63 14.63V5.79C15.6304 5.57152 15.5404 5.36262 15.3812 5.21294C15.2221 5.06326 15.008 4.98617 14.79 5Z"
            fill="var(--text-color)"
          />
          <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M14.79 3.58H0.79C0.353695 3.58 0 3.22631 0 2.79C0 2.35369 0.353695 2 0.79 2H3.44L4.62 0.72C5.07107 0.261411 5.68675 0.00217586 6.33 1.83491e-10H9.25C9.88387 -7.84652e-06 10.4918 0.25179 10.94 0.7L12.14 2H14.79C15.2263 2 15.58 2.35369 15.58 2.79C15.58 3.22631 15.2263 3.58 14.79 3.58ZM9.25 1.58H6.33C6.13008 1.58007 5.93744 1.65499 5.79 1.79L5.6 1.99H9.98L9.79 1.79C9.64364 1.65326 9.45029 1.57807 9.25 1.58Z"
            fill="var(--text-color)"
          />
          <path
            d="M4.04 6.79V9.79C4.04 10.2042 4.37579 10.54 4.79 10.54C5.20421 10.54 5.54 10.2042 5.54 9.79V6.79C5.54 6.37579 5.20421 6.04 4.79 6.04C4.37579 6.04 4.04 6.37579 4.04 6.79Z"
            fill="var(--text-color)"
          />
          <path
            d="M7.04 6.79V14.79C7.04 15.2042 7.37579 15.54 7.79 15.54C8.20421 15.54 8.54 15.2042 8.54 14.79V6.79C8.54 6.37579 8.20421 6.04 7.79 6.04C7.37579 6.04 7.04 6.37579 7.04 6.79Z"
            fill="var(--text-color)"
          />
          <path
            d="M10.04 6.79V9.79C10.04 10.2042 10.3758 10.54 10.79 10.54C11.2042 10.54 11.54 10.2042 11.54 9.79V6.79C11.54 6.37579 11.2042 6.04 10.79 6.04C10.3758 6.04 10.04 6.37579 10.04 6.79Z"
            fill="var(--text-color)"
          />
        </svg>
      </button>
    </div>
  ))
}

export default AdminSection
